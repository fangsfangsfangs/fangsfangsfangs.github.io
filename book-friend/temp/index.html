<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>bookmouse</title>
    <link rel="icon" href="https://fangsfangsfangs.github.io/book-friend/favicon.ico" type="image/x-icon" />
    <link rel="stylesheet" href="styles.css" />
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
  </head>
  <body>

    <!-- ============================================= -->
    <!-- === START OF THE MAIN APP CONTAINER === -->
    <!-- Everything that should be DISABLED when a popup is open goes in here. -->
    <div id="app-container">
      <!-- Fixed toolbar -->
      <div id="fixedToolbar" class="icon-bar fixed-toolbar">
        <button id="logoBtn" class="toolbar-logo-btn" title="Mousekeeping">
          <img src="https://fangsfangsfangs.github.io/book-friend/bookmouse1-logo.png" alt="Logo" class="toolbar-logo" />
        </button>
        <button id="homeBtn" title="welcome home"><i data-lucide="home"></i></button>
        <button id="showToReadBtn" title="to-read"><i data-lucide="notebook-pen"></i></button>
        <button id="favoritesBtn" title="faves"><i data-lucide="book-heart"></i></button>
        <button id="graveyardBtn" title="unfinished business"><i data-lucide="book-marked"></i></button>
        <button id="showReadBtn" title="quick list"><i data-lucide="bookmark-plus"></i></button>
      </div>

      <!-- Grid view - MOVED INSIDE app-container -->
      <div id="gridView" class="grid-area"></div>

      <!-- Add new book button - MOVED INSIDE app-container -->
      <button id="addBookBtn" title="Add New Book"><i data-lucide="plus"></i></button>
    </div>
    <!-- === END OF THE MAIN APP CONTAINER === -->
    <!-- ============================================= -->


    <!-- ============================================= -->
    <!-- === START OF THE POPUP CONTAINER === -->
    <!-- All popups and overlays live here, outside the main app. -->
    <div id="popup-container">
      <!-- BG Dimming effect -->
      <div id="dimOverlay" class="dim-overlay hidden"></div>
      
      <!-- Transparent container for book card popups -->
      <div id="BookCardpopup" class="popup-wrapper hidden">
        <div id="bookCard" class="book-card">
          <!-- Content is injected by JS -->
        </div>
      </div>
      
      <!-- Add new book popup -->
      <div id="addBookPopup" class="popup-wrapper hidden">
        <div class="popup-content book-card">
          <h3>Add a New Book</h3>
          <input placeholder="Title" id="addTitle" />
          <input placeholder="Author" id="addAuthor" />
          <input placeholder="Quote" id="addQuote" />
          <input placeholder="Review" id="addReview" />
          <input type="number" placeholder="Rating" id="addRating" />
          <input type="number" placeholder="Despair Level" id="addDespair" />
          <input placeholder="Tags (comma-separated)" id="addTags" />
          <button class="find-isbn-btn special-btn">Find ISBN</button>
          <input placeholder="ISBN" id="addIsbn" />
          <div class="popup-buttons">
            <div class="popup-footer-container">
              <div id="addFavoriteHeart" class="favorite-heart" title="Toggle Favorite">❤</div>
              <input type="month" id="dateReadInput" name="dateRead" />
              <div class="popup-action-buttons">
                <button id="addBookConfirm" class="special-btn">Add</button>
              </div>
              <button class="close-btn" id="closePopupBtn">×</button>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- === END OF THE POPUP CONTAINER === -->
    <!-- ============================================= -->

    <!-- Glitter overlay can stay outside as it's purely decorative -->
    <div id="glitterOverlay" class="glitter-overlay"></div>
    
    <!-- Scripts remain at the bottom -->
    <script>
      lucide.createIcons();
    </script>
    <script type="module" src="script.js"></script>
    <script>
      function setVh() {
        let vh = window.innerHeight * 0.01;
        document.documentElement.style.setProperty('--vh', `${vh}px`);
      }
      setVh();
      window.addEventListener('resize', setVh);
    </script>

  </body>
</html>
